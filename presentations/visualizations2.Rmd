How many games of data do you need before confidently predicting receiving stats? As an avid fantasy football player, I want to be able to properly react to trends throughout a season. There are four main stats I want to look at: targets, receptions, receiving yards, and receiving touchdowns. These are the stats most commonly relevant to receiving production in fantasy football. Using nflfastR, I can get play-by-play data dating back to 1999. I can create game logs myself using R to organize the data as I see fit.

```{r}
library(tidyverse)
library(ggrepel)
library(nflreadr)
library(nflplotR)
library(dplyr)
library(purrr)
```

NOTE: I prefer looking at full numbers rather than them in scientific notation. This ensures that.

```{r}
options(scipen = 9999)
```

I want to focus on the past 3 seasons in the NFL.

```{r}
szn2021 <- load_pbp(2021)
szn2022 <- load_pbp(2022)
szn2023 <- load_pbp(2023)
```

We only need pass plays. Specifically, pass plays with an intended target.

```{r}
szn2021 <- szn2021 |>
  filter(season_type == "REG", play_type == "pass", !is.na(receiver))
szn2022 <- szn2022 |>
  filter(season_type == "REG", play_type == "pass", !is.na(receiver))
szn2023 <- szn2023 |>
  filter(season_type == "REG", play_type == "pass", !is.na(receiver))
```

The only data I need is receiver_id, receiver, week, complete pass, and receiving yards. I also should add a new column called "clean id". This will allow me to have one column where I can see a player's name but also their ID so I can tell when there are two different players with the same name.

```{r}
szn2021 <- szn2021 |> 
  select(
  'receiver_id', 
  'receiver', 
  'week', 
  'complete_pass', 
  'receiving_yards',
  'pass_touchdown'
  )
szn2021$clean_id <- paste("2021", szn2021$receiver_id, szn2021$receiver)

szn2022 <- szn2022 |> 
  select(
  'receiver_id', 
  'receiver', 
  'week', 
  'complete_pass', 
  'receiving_yards',
  'pass_touchdown'
  )
szn2022$clean_id <- paste("2022", szn2022$receiver_id, szn2022$receiver)

szn2023 <- szn2023 |> 
  select(
  'receiver_id', 
  'receiver', 
  'week', 
  'complete_pass', 
  'receiving_yards',
  'pass_touchdown'
  )

szn2023$clean_id <- paste("2023", szn2023$receiver_id, szn2023$receiver)

```

I also need to change all the NAs in the receiving yard column to 0s. This will make calculations easier in the future.

```{r}
szn2021 <- szn2021 |>
  mutate(
    receiving_yards = ifelse(
      is.na(receiving_yards),
      0,
      receiving_yards
    )
  )

szn2022 <- szn2022 |>
  mutate(
    receiving_yards = ifelse(
      is.na(receiving_yards),
      0,
      receiving_yards
    )
  )

szn2023 <- szn2023 |>
  mutate(
    receiving_yards = ifelse(
      is.na(receiving_yards),
      0,
      receiving_yards
    )
  )
```

Let's divide this up by player and by week. We'll also add a column for games, since all we have right now is the week number.

```{r}
players2021 <- szn2021 |>
  group_by(clean_id, week) |>
  summarize(
    targets = n(),
    receptions = sum(complete_pass),
    yards = sum(receiving_yards),
    touchdowns = sum(pass_touchdown)
  ) |>
  group_by(clean_id) |>
  mutate(game = row_number())

players2022 <- szn2022 |>
  group_by(clean_id, week) |>
  summarize(
    targets = n(),
    receptions = sum(complete_pass),
    yards = sum(receiving_yards),
    touchdowns = sum(pass_touchdown)
  ) |>
  group_by(clean_id) |>
  mutate(game = row_number())

players2023 <- szn2023 |>
  group_by(clean_id, week) |>
  summarize(
    targets = n(),
    receptions = sum(complete_pass),
    yards = sum(receiving_yards),
    touchdowns = sum(pass_touchdown)
  ) |>
  group_by(clean_id) |>
  mutate(game = row_number())
```

Let's create a dataframe for each player. It will make following steps easier.

```{r}
gamelogs2021 <- players2021 |>
  split(f = players2021$clean_id)
  
gamelogs2022 <- players2022 |>
  split(f = players2022$clean_id)

gamelogs2023 <-players2023 |>
  split(f = players2023$clean_id)
```

This makes a list of dataframes of the game logs, but I want each game log to be its own dataframe. There is going to be a lot of output in the console, so we will need to increase the max print space.

Now, there are some caveats with this data. The biggest problem is that there is no way to tell whether a player did not play in a certain week or the player played but simply did not get targeted. Because of this, if a player did not get targeted in a certain week, we will make the assumption that the player did not play. It's an unfortunate drawback, but we'll chug along.

Time to get our "stints", which are simply just rolling averages. To do this, we'll need the zoo package.

```{r}
library(zoo)
```

Now we can get our stints.

```{r}
gamelogs2021 <- lapply(gamelogs2021, function(player) {
  player <- player |>
    mutate(
      targets_stint1 = rollmean(targets, k = 1, fill = NA, align = 'right'),
      receptions_stint1 = rollmean(receptions, k = 1, fill = NA, align = 'right'),
      yards_stint1 = rollmean(yards, k = 1, fill = NA, align = 'right'),
      touchdowns_stint1 = rollmean(touchdowns, k = 1, fill = NA, align = 'right'),
      
      
      targets_stint2 = rollmean(targets, k = 2, fill = NA, align = 'right'),
      receptions_stint2 = rollmean(receptions, k = 2, fill = NA, align = 'right'),
      yards_stint2 = rollmean(yards, k = 2, fill = NA, align = 'right'),
      touchdowns_stint2 = rollmean(touchdowns, k = 2, fill = NA, align = 'right'),
      
      targets_stint3 = rollmean(targets, k = 3, fill = NA, align = 'right'),
      receptions_stint3 = rollmean(receptions, k = 3, fill = NA, align = 'right'),
      yards_stint3 = rollmean(yards, k = 3, fill = NA, align = 'right'),
      touchdowns_stint3 = rollmean(touchdowns, k = 3, fill = NA, align = 'right'),
      
      targets_stint4 = rollmean(targets, k = 4, fill = NA, align = 'right'),
      receptions_stint4 = rollmean(receptions, k = 4, fill = NA, align = 'right'),
      yards_stint4 = rollmean(yards, k = 4, fill = NA, align = 'right'),
      touchdowns_stint4 = rollmean(touchdowns, k = 4, fill = NA, align = 'right'),
      
      targets_stint5 = rollmean(targets, k = 5, fill = NA, align = 'right'),
      receptions_stint5 = rollmean(receptions, k = 5, fill = NA, align = 'right'),
      yards_stint5 = rollmean(yards, k = 5, fill = NA, align = 'right'),
      touchdowns_stint5 = rollmean(touchdowns, k = 5, fill = NA, align = 'right'),
      
      targets_stint6 = rollmean(targets, k = 6, fill = NA, align = 'right'),
      receptions_stint6 = rollmean(receptions, k = 6, fill = NA, align = 'right'),
      yards_stint6 = rollmean(yards, k = 6, fill = NA, align = 'right'),
      touchdowns_stint6 = rollmean(touchdowns, k = 6, fill = NA, align = 'right'),
      
      targets_stint7 = rollmean(targets, k = 7, fill = NA, align = 'right'),
      receptions_stint7 = rollmean(receptions, k = 7, fill = NA, align = 'right'),
      yards_stint7 = rollmean(yards, k = 7, fill = NA, align = 'right'),
      touchdowns_stint7 = rollmean(touchdowns, k = 7, fill = NA, align = 'right'),
      
      targets_stint8 = rollmean(targets, k = 8, fill = NA, align = 'right'),
      receptions_stint8 = rollmean(receptions, k = 8, fill = NA, align = 'right'),
      yards_stint8 = rollmean(yards, k = 8, fill = NA, align = 'right'),
      touchdowns_stint8 = rollmean(touchdowns, k = 8, fill = NA, align = 'right'),
      
      targets_stint9 = rollmean(targets, k = 9, fill = NA, align = 'right'),
      receptions_stint9 = rollmean(receptions, k = 9, fill = NA, align = 'right'),
      yards_stint9 = rollmean(yards, k = 9, fill = NA, align = 'right'),
      touchdowns_stint9 = rollmean(touchdowns, k = 9, fill = NA, align = 'right'),
      
      targets_stint10 = rollmean(targets, k = 10, fill = NA, align = 'right'),
      receptions_stint10 = rollmean(receptions, k = 10, fill = NA, align = 'right'),
      yards_stint10 = rollmean(yards, k = 10, fill = NA, align = 'right'),
      touchdowns_stint10 = rollmean(touchdowns, k = 10, fill = NA, align = 'right'),
      
      targets_stint11 = rollmean(targets, k = 11, fill = NA, align = 'right'),
      receptions_stint11 = rollmean(receptions, k = 11, fill = NA, align = 'right'),
      yards_stint11 = rollmean(yards, k = 11, fill = NA, align = 'right'),
      touchdowns_stint11 = rollmean(touchdowns, k = 11, fill = NA, align = 'right'),
      
      targets_stint12 = rollmean(targets, k = 12, fill = NA, align = 'right'),
      receptions_stint12 = rollmean(receptions, k = 12, fill = NA, align = 'right'),
      yards_stint12 = rollmean(yards, k = 12, fill = NA, align = 'right'),
      touchdowns_stint12 = rollmean(touchdowns, k = 12, fill = NA, align = 'right'),
      
      targets_stint13 = rollmean(targets, k = 13, fill = NA, align = 'right'),
      receptions_stint13 = rollmean(receptions, k = 13, fill = NA, align = 'right'),
      yards_stint13 = rollmean(yards, k = 13, fill = NA, align = 'right'),
      touchdowns_stint13 = rollmean(touchdowns, k = 13, fill = NA, align = 'right'),
      
      targets_stint14 = rollmean(targets, k = 14, fill = NA, align = 'right'),
      receptions_stint14 = rollmean(receptions, k = 14, fill = NA, align = 'right'),
      yards_stint14 = rollmean(yards, k = 14, fill = NA, align = 'right'),
      touchdowns_stint14 = rollmean(touchdowns, k = 14, fill = NA, align = 'right'),
      
      targets_stint15 = rollmean(targets, k = 15, fill = NA, align = 'right'),
      receptions_stint15 = rollmean(receptions, k = 15, fill = NA, align = 'right'),
      yards_stint15 = rollmean(yards, k = 15, fill = NA, align = 'right'),
      touchdowns_stint15 = rollmean(touchdowns, k = 15, fill = NA, align = 'right'),
      
      targets_stint16 = rollmean(targets, k = 16, fill = NA, align = 'right'),
      receptions_stint16 = rollmean(receptions, k = 16, fill = NA, align = 'right'),
      yards_stint16 = rollmean(yards, k = 16, fill = NA, align = 'right'),
      touchdowns_stint16 = rollmean(touchdowns, k = 16, fill = NA, align = 'right')
    )
}
)

gamelogs2022 <- lapply(gamelogs2022, function(player) {
  player <- player |>
    mutate(
      targets_stint1 = rollmean(targets, k = 1, fill = NA, align = 'right'),
      receptions_stint1 = rollmean(receptions, k = 1, fill = NA, align = 'right'),
      yards_stint1 = rollmean(yards, k = 1, fill = NA, align = 'right'),
      touchdowns_stint1 = rollmean(touchdowns, k = 1, fill = NA, align = 'right'),
      
      
      targets_stint2 = rollmean(targets, k = 2, fill = NA, align = 'right'),
      receptions_stint2 = rollmean(receptions, k = 2, fill = NA, align = 'right'),
      yards_stint2 = rollmean(yards, k = 2, fill = NA, align = 'right'),
      touchdowns_stint2 = rollmean(touchdowns, k = 2, fill = NA, align = 'right'),
      
      targets_stint3 = rollmean(targets, k = 3, fill = NA, align = 'right'),
      receptions_stint3 = rollmean(receptions, k = 3, fill = NA, align = 'right'),
      yards_stint3 = rollmean(yards, k = 3, fill = NA, align = 'right'),
      touchdowns_stint3 = rollmean(touchdowns, k = 3, fill = NA, align = 'right'),
      
      targets_stint4 = rollmean(targets, k = 4, fill = NA, align = 'right'),
      receptions_stint4 = rollmean(receptions, k = 4, fill = NA, align = 'right'),
      yards_stint4 = rollmean(yards, k = 4, fill = NA, align = 'right'),
      touchdowns_stint4 = rollmean(touchdowns, k = 4, fill = NA, align = 'right'),
      
      targets_stint5 = rollmean(targets, k = 5, fill = NA, align = 'right'),
      receptions_stint5 = rollmean(receptions, k = 5, fill = NA, align = 'right'),
      yards_stint5 = rollmean(yards, k = 5, fill = NA, align = 'right'),
      touchdowns_stint5 = rollmean(touchdowns, k = 5, fill = NA, align = 'right'),
      
      targets_stint6 = rollmean(targets, k = 6, fill = NA, align = 'right'),
      receptions_stint6 = rollmean(receptions, k = 6, fill = NA, align = 'right'),
      yards_stint6 = rollmean(yards, k = 6, fill = NA, align = 'right'),
      touchdowns_stint6 = rollmean(touchdowns, k = 6, fill = NA, align = 'right'),
      
      targets_stint7 = rollmean(targets, k = 7, fill = NA, align = 'right'),
      receptions_stint7 = rollmean(receptions, k = 7, fill = NA, align = 'right'),
      yards_stint7 = rollmean(yards, k = 7, fill = NA, align = 'right'),
      touchdowns_stint7 = rollmean(touchdowns, k = 7, fill = NA, align = 'right'),
      
      targets_stint8 = rollmean(targets, k = 8, fill = NA, align = 'right'),
      receptions_stint8 = rollmean(receptions, k = 8, fill = NA, align = 'right'),
      yards_stint8 = rollmean(yards, k = 8, fill = NA, align = 'right'),
      touchdowns_stint8 = rollmean(touchdowns, k = 8, fill = NA, align = 'right'),
      
      targets_stint9 = rollmean(targets, k = 9, fill = NA, align = 'right'),
      receptions_stint9 = rollmean(receptions, k = 9, fill = NA, align = 'right'),
      yards_stint9 = rollmean(yards, k = 9, fill = NA, align = 'right'),
      touchdowns_stint9 = rollmean(touchdowns, k = 9, fill = NA, align = 'right'),
      
      targets_stint10 = rollmean(targets, k = 10, fill = NA, align = 'right'),
      receptions_stint10 = rollmean(receptions, k = 10, fill = NA, align = 'right'),
      yards_stint10 = rollmean(yards, k = 10, fill = NA, align = 'right'),
      touchdowns_stint10 = rollmean(touchdowns, k = 10, fill = NA, align = 'right'),
      
      targets_stint11 = rollmean(targets, k = 11, fill = NA, align = 'right'),
      receptions_stint11 = rollmean(receptions, k = 11, fill = NA, align = 'right'),
      yards_stint11 = rollmean(yards, k = 11, fill = NA, align = 'right'),
      touchdowns_stint11 = rollmean(touchdowns, k = 11, fill = NA, align = 'right'),
      
      targets_stint12 = rollmean(targets, k = 12, fill = NA, align = 'right'),
      receptions_stint12 = rollmean(receptions, k = 12, fill = NA, align = 'right'),
      yards_stint12 = rollmean(yards, k = 12, fill = NA, align = 'right'),
      touchdowns_stint12 = rollmean(touchdowns, k = 12, fill = NA, align = 'right'),
      
      targets_stint13 = rollmean(targets, k = 13, fill = NA, align = 'right'),
      receptions_stint13 = rollmean(receptions, k = 13, fill = NA, align = 'right'),
      yards_stint13 = rollmean(yards, k = 13, fill = NA, align = 'right'),
      touchdowns_stint13 = rollmean(touchdowns, k = 13, fill = NA, align = 'right'),
      
      targets_stint14 = rollmean(targets, k = 14, fill = NA, align = 'right'),
      receptions_stint14 = rollmean(receptions, k = 14, fill = NA, align = 'right'),
      yards_stint14 = rollmean(yards, k = 14, fill = NA, align = 'right'),
      touchdowns_stint14 = rollmean(touchdowns, k = 14, fill = NA, align = 'right'),
      
      targets_stint15 = rollmean(targets, k = 15, fill = NA, align = 'right'),
      receptions_stint15 = rollmean(receptions, k = 15, fill = NA, align = 'right'),
      yards_stint15 = rollmean(yards, k = 15, fill = NA, align = 'right'),
      touchdowns_stint15 = rollmean(touchdowns, k = 15, fill = NA, algin = 'right'),
      
      targets_stint16 = rollmean(targets, k = 16, fill = NA, align = 'right'),
      receptions_stint16 = rollmean(receptions, k = 16, fill = NA, align = 'right'),
      yards_stint16 = rollmean(yards, k = 16, fill = NA, align = 'right'),
      touchdowns_stint16 = rollmean(touchdowns, k = 16, fill = NA, align = 'right')
    )
}
)

gamelogs2023 <- lapply(gamelogs2023, function(player) {
  player <- player |>
    mutate(
      targets_stint1 = rollmean(targets, k = 1, fill = NA, align = 'right'),
      receptions_stint1 = rollmean(receptions, k = 1, fill = NA, align = 'right'),
      yards_stint1 = rollmean(yards, k = 1, fill = NA, align = 'right'),
      touchdowns_stint1 = rollmean(touchdowns, k = 1, fill = NA, align = 'right'),
      
      
      targets_stint2 = rollmean(targets, k = 2, fill = NA, align = 'right'),
      receptions_stint2 = rollmean(receptions, k = 2, fill = NA, align = 'right'),
      yards_stint2 = rollmean(yards, k = 2, fill = NA, align = 'right'),
      touchdowns_stint2 = rollmean(touchdowns, k = 2, fill = NA, align = 'right'),
      
      targets_stint3 = rollmean(targets, k = 3, fill = NA, align = 'right'),
      receptions_stint3 = rollmean(receptions, k = 3, fill = NA, align = 'right'),
      yards_stint3 = rollmean(yards, k = 3, fill = NA, align = 'right'),
      touchdowns_stint3 = rollmean(touchdowns, k = 3, fill = NA, align = 'right'),
      
      targets_stint4 = rollmean(targets, k = 4, fill = NA, align = 'right'),
      receptions_stint4 = rollmean(receptions, k = 4, fill = NA, align = 'right'),
      yards_stint4 = rollmean(yards, k = 4, fill = NA, align = 'right'),
      touchdowns_stint4 = rollmean(touchdowns, k = 4, fill = NA, align = 'right'),
      
      targets_stint5 = rollmean(targets, k = 5, fill = NA, align = 'right'),
      receptions_stint5 = rollmean(receptions, k = 5, fill = NA, align = 'right'),
      yards_stint5 = rollmean(yards, k = 5, fill = NA, align = 'right'),
      touchdowns_stint5 = rollmean(touchdowns, k = 5, fill = NA, align = 'right'),
      
      targets_stint6 = rollmean(targets, k = 6, fill = NA, align = 'right'),
      receptions_stint6 = rollmean(receptions, k = 6, fill = NA, align = 'right'),
      yards_stint6 = rollmean(yards, k = 6, fill = NA, align = 'right'),
      touchdowns_stint6 = rollmean(touchdowns, k = 6, fill = NA, align = 'right'),
      
      targets_stint7 = rollmean(targets, k = 7, fill = NA, align = 'right'),
      receptions_stint7 = rollmean(receptions, k = 7, fill = NA, align = 'right'),
      yards_stint7 = rollmean(yards, k = 7, fill = NA, align = 'right'),
      touchdowns_stint7 = rollmean(touchdowns, k = 7, fill = NA, align = 'right'),
      
      targets_stint8 = rollmean(targets, k = 8, fill = NA, align = 'right'),
      receptions_stint8 = rollmean(receptions, k = 8, fill = NA, align = 'right'),
      yards_stint8 = rollmean(yards, k = 8, fill = NA, align = 'right'),
      touchdowns_stint8 = rollmean(touchdowns, k = 8, fill = NA, align = 'right'),
      
      targets_stint9 = rollmean(targets, k = 9, fill = NA, align = 'right'),
      receptions_stint9 = rollmean(receptions, k = 9, fill = NA, align = 'right'),
      yards_stint9 = rollmean(yards, k = 9, fill = NA, align = 'right'),
      touchdowns_stint9 = rollmean(touchdowns, k = 9, fill = NA, align = 'right'),
      
      targets_stint10 = rollmean(targets, k = 10, fill = NA, align = 'right'),
      receptions_stint10 = rollmean(receptions, k = 10, fill = NA, align = 'right'),
      yards_stint10 = rollmean(yards, k = 10, fill = NA, align = 'right'),
      touchdowns_stint10 = rollmean(touchdowns, k = 10, fill = NA, align = 'right'),
      
      targets_stint11 = rollmean(targets, k = 11, fill = NA, align = 'right'),
      receptions_stint11 = rollmean(receptions, k = 11, fill = NA, align = 'right'),
      yards_stint11 = rollmean(yards, k = 11, fill = NA, align = 'right'),
      touchdowns_stint11 = rollmean(touchdowns, k = 11, fill = NA, align = 'right'),
      
      targets_stint12 = rollmean(targets, k = 12, fill = NA, align = 'right'),
      receptions_stint12 = rollmean(receptions, k = 12, fill = NA, align = 'right'),
      yards_stint12 = rollmean(yards, k = 12, fill = NA, align = 'right'),
      touchdowns_stint12 = rollmean(touchdowns, k = 12, fill = NA, align = 'right'),
      
      targets_stint13 = rollmean(targets, k = 13, fill = NA, align = 'right'),
      receptions_stint13 = rollmean(receptions, k = 13, fill = NA, align = 'right'),
      yards_stint13 = rollmean(yards, k = 13, fill = NA, align = 'right'),
      touchdowns_stint13 = rollmean(touchdowns, k = 13, fill = NA, align = 'right'),
      
      targets_stint14 = rollmean(targets, k = 14, fill = NA, align = 'right'),
      receptions_stint14 = rollmean(receptions, k = 14, fill = NA, align = 'right'),
      yards_stint14 = rollmean(yards, k = 14, fill = NA, align = 'right'),
      touchdowns_stint14 = rollmean(touchdowns, k = 14, fill = NA, align = 'right'),
      
      targets_stint15 = rollmean(targets, k = 15, fill = NA, align = 'right'),
      receptions_stint15 = rollmean(receptions, k = 15, fill = NA, align = 'right'),
      yards_stint15 = rollmean(yards, k = 15, fill = NA, align = 'right'),
      touchdowns_stint15 = rollmean(touchdowns, k = 15, fill = NA, align = 'right'),
      
      targets_stint16 = rollmean(targets, k = 16, fill = NA, align = 'right'),
      receptions_stint16 = rollmean(receptions, k = 16, fill = NA, align = 'right'),
      yards_stint16 = rollmean(yards, k = 16, fill = NA, align = 'right'),
      touchdowns_stint16 = rollmean(touchdowns, k = 16, fill = NA, align = 'right')
    )
}
)
```


We will need a column for the next game's stats, too. This will make following steps easier.

```{r}
gamelogs2021 <- gamelogs2021 |>
  map(~ mutate(.x,
    next_targets = lead(targets, n = 1),
    next_receptions = lead(receptions, n = 1),
    next_yards = lead(yards, n = 1),
    next_touchdowns = lead(touchdowns, n = 1)
  ))

gamelogs2022 <- gamelogs2022 |>
  map(~ mutate(.x,
    next_targets = lead(targets, n = 1),
    next_receptions = lead(receptions, n = 1),
    next_yards = lead(yards, n = 1),
    next_touchdowns = lead(touchdowns, n = 1)
  ))

gamelogs2023 <- gamelogs2023 |>
  map(~ mutate(.x,
    next_targets = lead(targets, n = 1),
    next_receptions = lead(receptions, n = 1),
    next_yards = lead(yards, n = 1),
    next_touchdowns = lead(touchdowns, n = 1)
  ))
```


Let's make new dataframes for each type of stint. I'll do one at a time

```{r}
first_stint2021 <- map(gamelogs2021, ~ select(
  .x,
  clean_id,
  targets_stint1,
  next_targets,
  receptions_stint1,
  next_receptions,
  yards_stint1,
  next_yards,
  touchdowns_stint1,
  next_touchdowns
)) |>
  bind_rows() |>
  na.omit()

first_stint2022 <- map(gamelogs2022, ~ select(
  .x,
  clean_id,
  targets_stint1,
  next_targets,
  receptions_stint1,
  next_receptions,
  yards_stint1,
  next_yards,
  touchdowns_stint1,
  next_touchdowns
)) |>
  bind_rows() |>
  na.omit()

first_stint2023 <- map(gamelogs2023, ~ select(
  .x,
  clean_id,
  targets_stint1,
  next_targets,
  receptions_stint1,
  next_receptions,
  yards_stint1,
  next_yards,
  touchdowns_stint1,
  next_touchdowns
)) |>
  bind_rows() |>
  na.omit()

first_stint <- bind_rows(first_stint2021, first_stint2022, first_stint2023)

```



```{r}
second_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint2,
    next_targets,
    receptions_stint2,
    next_receptions,
    yards_stint2,
    next_yards,
    touchdowns_stint2,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint2,
    next_targets,
    receptions_stint2,
    next_receptions,
    yards_stint2,
    next_yards,
    touchdowns_stint2,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint2,
    next_targets,
    receptions_stint2,
    next_receptions,
    yards_stint2,
    next_yards,
    touchdowns_stint2,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
third_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint3,
    next_targets,
    receptions_stint3,
    next_receptions,
    yards_stint3,
    next_yards,
    touchdowns_stint3,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint3,
    next_targets,
    receptions_stint3,
    next_receptions,
    yards_stint3,
    next_yards,
    touchdowns_stint3,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint3,
    next_targets,
    receptions_stint3,
    next_receptions,
    yards_stint3,
    next_yards,
    touchdowns_stint3,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
fourth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint4,
    next_targets,
    receptions_stint4,
    next_receptions,
    yards_stint4,
    next_yards,
    touchdowns_stint4,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint4,
    next_targets,
    receptions_stint4,
    next_receptions,
    yards_stint4,
    next_yards,
    touchdowns_stint4,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint4,
    next_targets,
    receptions_stint4,
    next_receptions,
    yards_stint4,
    next_yards,
    touchdowns_stint4,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
fifth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint5,
    next_targets,
    receptions_stint5,
    next_receptions,
    yards_stint5,
    next_yards,
    touchdowns_stint5,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint5,
    next_targets,
    receptions_stint5,
    next_receptions,
    yards_stint5,
    next_yards,
    touchdowns_stint5,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint5,
    next_targets,
    receptions_stint5,
    next_receptions,
    yards_stint5,
    next_yards,
    touchdowns_stint5,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
sixth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint6,
    next_targets,
    receptions_stint6,
    next_receptions,
    yards_stint6,
    next_yards,
    touchdowns_stint6,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint6,
    next_targets,
    receptions_stint6,
    next_receptions,
    yards_stint6,
    next_yards,
    touchdowns_stint6,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint6,
    next_targets,
    receptions_stint6,
    next_receptions,
    yards_stint6,
    next_yards,
    touchdowns_stint6,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
seventh_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint7,
    next_targets,
    receptions_stint7,
    next_receptions,
    yards_stint7,
    next_yards,
    touchdowns_stint7,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint7,
    next_targets,
    receptions_stint7,
    next_receptions,
    yards_stint7,
    next_yards,
    touchdowns_stint7,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint7,
    next_targets,
    receptions_stint7,
    next_receptions,
    yards_stint7,
    next_yards,
    touchdowns_stint7,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
eighth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint8,
    next_targets,
    receptions_stint8,
    next_receptions,
    yards_stint8,
    next_yards,
    touchdowns_stint8,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint8,
    next_targets,
    receptions_stint8,
    next_receptions,
    yards_stint8,
    next_yards,
    touchdowns_stint8,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint8,
    next_targets,
    receptions_stint8,
    next_receptions,
    yards_stint8,
    next_yards,
    touchdowns_stint8,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
ninth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint9,
    next_targets,
    receptions_stint9,
    next_receptions,
    yards_stint9,
    next_yards,
    touchdowns_stint9,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint9,
    next_targets,
    receptions_stint9,
    next_receptions,
    yards_stint9,
    next_yards,
    touchdowns_stint9,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint9,
    next_targets,
    receptions_stint9,
    next_receptions,
    yards_stint9,
    next_yards,
    touchdowns_stint9,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
tenth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint10,
    next_targets,
    receptions_stint10,
    next_receptions,
    yards_stint2,
    next_yards,
    touchdowns_stint10,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint10,
    next_targets,
    receptions_stint10,
    next_receptions,
    yards_stint10,
    next_yards,
    touchdowns_stint10,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint10,
    next_targets,
    receptions_stint10,
    next_receptions,
    yards_stint10,
    next_yards,
    touchdowns_stint10,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
eleventh_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint11,
    next_targets,
    receptions_stint11,
    next_receptions,
    yards_stint11,
    next_yards,
    touchdowns_stint11,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint11,
    next_targets,
    receptions_stint11,
    next_receptions,
    yards_stint11,
    next_yards,
    touchdowns_stint11,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint11,
    next_targets,
    receptions_stint11,
    next_receptions,
    yards_stint11,
    next_yards,
    touchdowns_stint11,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
twelfth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint12,
    next_targets,
    receptions_stint12,
    next_receptions,
    yards_stint12,
    next_yards,
    touchdowns_stint12,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint12,
    next_targets,
    receptions_stint12,
    next_receptions,
    yards_stint12,
    next_yards,
    touchdowns_stint12,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint12,
    next_targets,
    receptions_stint12,
    next_receptions,
    yards_stint12,
    next_yards,
    touchdowns_stint12,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
thirteenth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint13,
    next_targets,
    receptions_stint13,
    next_receptions,
    yards_stint13,
    next_yards,
    touchdowns_stint13,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint13,
    next_targets,
    receptions_stint13,
    next_receptions,
    yards_stint13,
    next_yards,
    touchdowns_stint13,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint13,
    next_targets,
    receptions_stint13,
    next_receptions,
    yards_stint13,
    next_yards,
    touchdowns_stint13,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
fourteenth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint14,
    next_targets,
    receptions_stint14,
    next_receptions,
    yards_stint14,
    next_yards,
    touchdowns_stint14,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint14,
    next_targets,
    receptions_stint14,
    next_receptions,
    yards_stint14,
    next_yards,
    touchdowns_stint14,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint14,
    next_targets,
    receptions_stint14,
    next_receptions,
    yards_stint14,
    next_yards,
    touchdowns_stint14,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
fifteenth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint15,
    next_targets,
    receptions_stint15,
    next_receptions,
    yards_stint15,
    next_yards,
    touchdowns_stint15,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint15,
    next_targets,
    receptions_stint15,
    next_receptions,
    yards_stint15,
    next_yards,
    touchdowns_stint15,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint15,
    next_targets,
    receptions_stint15,
    next_receptions,
    yards_stint15,
    next_yards,
    touchdowns_stint15,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```



```{r}
sixteenth_stint <- bind_rows(
  map(gamelogs2021, ~ select(
    .x,
    clean_id,
    targets_stint16,
    next_targets,
    receptions_stint16,
    next_receptions,
    yards_stint16,
    next_yards,
    touchdowns_stint16,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2022, ~ select(
    .x,
    clean_id,
    targets_stint16,
    next_targets,
    receptions_stint16,
    next_receptions,
    yards_stint16,
    next_yards,
    touchdowns_stint16,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit(),
  map(gamelogs2023, ~ select(
    .x,
    clean_id,
    targets_stint16,
    next_targets,
    receptions_stint16,
    next_receptions,
    yards_stint16,
    next_yards,
    touchdowns_stint16,
    next_touchdowns
  )) |>
    bind_rows() |>
    na.omit()
  )
```

Now that we have our stints, we can perform linear regressions.

```{r}
fit_targets1 <- lm(next_targets ~ targets_stint1, data = first_stint)
fit_receptions1 <- lm(next_receptions ~ receptions_stint1, data = first_stint)
fit_yards1 <- lm(next_yards ~ yards_stint1, data = first_stint)
fit_touchdowns1 <- lm(next_touchdowns ~ touchdowns_stint1, data = first_stint)

fit_targets2 <- lm(next_targets ~ targets_stint2, data = second_stint)
fit_receptions2 <- lm(next_receptions ~ receptions_stint2, data = second_stint)
fit_yards2 <- lm(next_yards ~ yards_stint2, data = second_stint)
fit_touchdowns2 <- lm(next_touchdowns ~ touchdowns_stint2, data = second_stint)

fit_targets3 <- lm(next_targets ~ targets_stint3, data = third_stint)
fit_receptions3 <- lm(next_receptions ~ receptions_stint3, data = third_stint)
fit_yards3 <- lm(next_yards ~ yards_stint3, data = third_stint)
fit_touchdowns3 <- lm(next_touchdowns ~ touchdowns_stint3, data = third_stint)

fit_targets4 <- lm(next_targets ~ targets_stint4, data = fourth_stint)
fit_receptions4 <- lm(next_receptions ~ receptions_stint4, data = fourth_stint)
fit_yards4 <- lm(next_yards ~ yards_stint4, data = fourth_stint)
fit_touchdowns4 <- lm(next_touchdowns ~ touchdowns_stint4, data = fourth_stint)

fit_targets5 <- lm(next_targets ~ targets_stint5, data = fifth_stint)
fit_receptions5 <- lm(next_receptions ~ receptions_stint5, data = fifth_stint)
fit_yards5 <- lm(next_yards ~ yards_stint5, data = fifth_stint)
fit_touchdowns5 <- lm(next_touchdowns ~ touchdowns_stint5, data = fifth_stint)

fit_targets6 <- lm(next_targets ~ targets_stint6, data = sixth_stint)
fit_receptions6 <- lm(next_receptions ~ receptions_stint6, data = sixth_stint)
fit_yards6 <- lm(next_yards ~ yards_stint6, data = sixth_stint)
fit_touchdowns6 <- lm(next_touchdowns ~ touchdowns_stint6, data = sixth_stint)

fit_targets7 <- lm(next_targets ~ targets_stint7, data = seventh_stint)
fit_receptions7 <- lm(next_receptions ~ receptions_stint7, data = seventh_stint)
fit_yards7 <- lm(next_yards ~ yards_stint7, data = seventh_stint)
fit_touchdowns7 <- lm(next_touchdowns ~ touchdowns_stint7, data = seventh_stint)

fit_targets8 <- lm(next_targets ~ targets_stint8, data = eighth_stint)
fit_receptions8 <- lm(next_receptions ~ receptions_stint8, data = eighth_stint)
fit_yards8 <- lm(next_yards ~ yards_stint8, data = eighth_stint)
fit_touchdowns8 <- lm(next_touchdowns ~ touchdowns_stint8, data = eighth_stint)

fit_targets9 <- lm(next_targets ~ targets_stint9, data = ninth_stint)
fit_receptions9 <- lm(next_receptions ~ receptions_stint9, data = ninth_stint)
fit_yards9 <- lm(next_yards ~ yards_stint9, data = ninth_stint)
fit_touchdowns9 <- lm(next_touchdowns ~ touchdowns_stint9, data = ninth_stint)

fit_targets10 <- lm(next_targets ~ targets_stint10, data = tenth_stint)
fit_receptions10 <- lm(next_receptions ~ receptions_stint10, data = tenth_stint)
fit_yards10 <- lm(next_yards ~ yards_stint10, data = tenth_stint)
fit_touchdowns10 <- lm(next_touchdowns ~ touchdowns_stint10, data = tenth_stint)

fit_targets11 <- lm(next_targets ~ targets_stint11, data = eleventh_stint)
fit_receptions11 <- lm(next_receptions ~ receptions_stint11, data = eleventh_stint)
fit_yards11 <- lm(next_yards ~ yards_stint11, data = eleventh_stint)
fit_touchdowns11 <- lm(next_touchdowns ~ touchdowns_stint11, data = eleventh_stint)

fit_targets12 <- lm(next_targets ~ targets_stint12, data = twelfth_stint)
fit_receptions12 <- lm(next_receptions ~ receptions_stint12, data = twelfth_stint)
fit_yards12 <- lm(next_yards ~ yards_stint12, data = twelfth_stint)
fit_touchdowns12 <- lm(next_touchdowns ~ touchdowns_stint12, data = twelfth_stint)

fit_targets13 <- lm(next_targets ~ targets_stint13, data = thirteenth_stint)
fit_receptions13 <- lm(next_receptions ~ receptions_stint13, data = thirteenth_stint)
fit_yards13 <- lm(next_yards ~ yards_stint13, data = thirteenth_stint)
fit_touchdowns13 <- lm(next_touchdowns ~ touchdowns_stint13, data = thirteenth_stint)

fit_targets14 <- lm(next_targets ~ targets_stint14, data = fourteenth_stint)
fit_receptions14 <- lm(next_receptions ~ receptions_stint14, data = fourteenth_stint)
fit_yards14 <- lm(next_yards ~ yards_stint14, data = fourteenth_stint)
fit_touchdowns14 <- lm(next_touchdowns ~ touchdowns_stint14, data = fourteenth_stint)

fit_targets15 <- lm(next_targets ~ targets_stint15, data = fifteenth_stint)
fit_receptions15 <- lm(next_receptions ~ receptions_stint15, data = fifteenth_stint)
fit_yards15 <- lm(next_yards ~ yards_stint15, data = fifteenth_stint)
fit_touchdowns15 <- lm(next_touchdowns ~ touchdowns_stint15, data = fifteenth_stint)

fit_targets16 <- lm(next_targets ~ targets_stint16, data = sixteenth_stint)
fit_receptions16 <- lm(next_receptions ~ receptions_stint16, data = sixteenth_stint)
fit_yards16 <- lm(next_yards ~ yards_stint16, data = sixteenth_stint)
fit_touchdowns16 <- lm(next_touchdowns ~ touchdowns_stint16, data = sixteenth_stint)
```

Let's take a look at targets!

```{r}
summary(fit_targets1)
summary(fit_targets2)
summary(fit_targets3)
summary(fit_targets4)
summary(fit_targets5)
summary(fit_targets6)
summary(fit_targets7)
summary(fit_targets8)
summary(fit_targets9)
summary(fit_targets10)
summary(fit_targets11)
summary(fit_targets12)
summary(fit_targets13)
summary(fit_targets14)
summary(fit_targets15)
summary(fit_targets16)
```

With no other context taken into account, the most reliable stretch of games within a season for predicting the number of targets in the following game is 6 games. However, not even this reaches the ideal R-squared value. We were aiming for 0.5 but only reached 0.3872.

No one wants to just look at a bunch of linear model summaries, though. We need something more visually appealing.

```{r}
fit_targets <- list(
  fit_targets1, 
  fit_targets2, 
  fit_targets3, 
  fit_targets4, 
  fit_targets5,
  fit_targets6,
  fit_targets7,
  fit_targets8,
  fit_targets9,
  fit_targets10,
  fit_targets11,
  fit_targets12,
  fit_targets13,
  fit_targets14,
  fit_targets15,
  fit_targets16
  )

r_squareds <- sapply(fit_targets, function(fit) summary(fit)$r.squared)

targets_reliability <- as.data.frame(
  list(
    games = c(1:16),
    r_squared = c(r_squareds[1:16])
  )
)

ggplot() + geom_line(data=targets_reliability, aes(x=games, y=r_squared), color="cyan") +
  labs(x="Games Played", 
       y="R Squared", 
       title="6 Games is Enough", 
       caption="Source: nflfastR | By Kaodinna Onwumechili") +
  theme_minimal()
```


This is much better. Now, we need to replicate this for the other three stats. Let's do receptions.

```{r}
fit_receptions <- list(
  fit_receptions1,
  fit_receptions2,
  fit_receptions3,
  fit_receptions4,
  fit_receptions5,
  fit_receptions6,
  fit_receptions7,
  fit_receptions8,
  fit_receptions9,
  fit_receptions10,
  fit_receptions11,
  fit_receptions12,
  fit_receptions13,
  fit_receptions14,
  fit_receptions15,
  fit_receptions16
)

receptions_reliability <- as.data.frame(
  list(
    games = c(1:16),
    r_squared = c(
      sapply(fit_receptions, function(fit) summary(fit)$r.squared)
    )
  )
)

ggplot() + geom_line(data=receptions_reliability, aes(x=games, y=r_squared), color="magenta") +
  labs(x="Games Played", 
       y="R Squared", 
       title="6 Games is Still Enough", 
       caption="Source: nflfastR | By Kaodinna Onwumechili") +
  theme_minimal()
```

We can see a similar curve to that of the targets line chart. This is to be expected, since receptions come from targets and there's usually not much variation game to game in regards to what proportion of players' targets they catch. Since targets are more representative of an offense's process than receptions are, though, it also is unsurprising to see that it is easier to predict future targets than it is to predict future receptions.

Now, yards!

```{r}
fit_yards <- list(
  fit_yards1,
  fit_yards2,
  fit_yards3,
  fit_yards4,
  fit_yards5,
  fit_yards6,
  fit_yards7,
  fit_yards8,
  fit_yards9,
  fit_yards10,
  fit_yards11,
  fit_yards12,
  fit_yards13,
  fit_yards14,
  fit_yards15,
  fit_yards16
)

yards_reliability <- as.data.frame(
  list(
    games = c(1:16),
    r_squared = c(
      sapply(fit_yards, function(fit) summary(fit)$r.squared)
    )
  )
)

ggplot() + geom_line(data=yards_reliability, aes(x=games, y=r_squared), color="yellow") +
  labs(x="Games Played", 
       y="R Squared", 
       title="Turn the 6 Upside Down, It's a 9 Now", 
       caption="Source: nflfastR | By Kaodinna Onwumechili") +
  theme_minimal()
```

Another unsurprising result: it takes more games to predict yards than receptions and targets. Yards are less of a process-oriented data point than receptions or targets. That's also why it is less reliable, as shown by its r-squared.

Lastly, we'll look at touchdowns.

```{r}
fit_touchdowns <- list(
  fit_touchdowns1,
  fit_touchdowns2,
  fit_touchdowns3,
  fit_touchdowns4,
  fit_touchdowns5,
  fit_touchdowns6,
  fit_touchdowns7,
  fit_touchdowns8,
  fit_touchdowns9,
  fit_touchdowns10,
  fit_touchdowns11,
  fit_touchdowns12,
  fit_touchdowns13,
  fit_touchdowns14,
  fit_touchdowns15,
  fit_touchdowns16
)

touchdowns_reliability <- as.data.frame(
  list(
    games = c(1:16),
    r_squared = c(
      sapply(fit_touchdowns, function(fit) summary(fit)$r.squared)
    )
  )
)

ggplot() + geom_line(data=touchdowns_reliability, aes(x=games, y=r_squared), color="black") +
  labs(x="Games Played", 
       y="R Squared", 
       title="Almost Impossible to Predict", 
       caption="Source: nflfastR | By Kaodinna Onwumechili") +
  theme_minimal()
```

As you can see, it is very hard to predict touchdowns, and it takes a large data set (relative to length of a football season) to see even slight correlation.


